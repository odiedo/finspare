<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FinSpare</title>
    <link rel="stylesheet" href="assets/fonts/css/all.css">
    <!-- Bootstrap core CSS -->
    <link href="assets/dist/css/bootstrap.css" rel="stylesheet">
    <link href="assets/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <main id="sec">
      <div class="container-fluid">
        <div class="content">
            <div class="row one bg-transparent border-0">
                <div class="col-md-5 side-image p-0 m-0">
                    <div class="side-image-one p-0 m-0 d-flex justify-content-center">
                        <!-- <img src="assets/img/b1.jpg" alt=""> -->
                        <div class="span-one mr-2">
                            <span>FinSpare</span>
                        </div>
                        <span class="pt-4">
                            <i class="fas fa-car-battery fa-4x fas-onetr"></i><br>
                            <i class="fas fas-one">Fast</i><br>
                            <i class="fas fas-two">Affordable</i><br>
                            <i class="fas fas-three">Reliable</i><br>
                        </span>
                    </div>
                </div>
                <div class="col-md-7">
                    <div class="mt-4">
                        <div class="tabs-one">
                            <!-- Tab content -->
                            <div class="tab-content" id="phoneTabContent">
                                <!-- driver tab -->
                                <div class="tab-pane fade show active" id="driver" role="tabpanel">
                                    <div class="driver ">
                                        <div class="d-flex justify-content-between p-3 mt-3">
                                            <h3>Truck Spares</h3>
                                        </div>
                                        <div class="truck-details pb-2">
                                            <div class="truck-plate">
                                                <h4>KBH 345Z</h4>
                                            </div>
                                            <div class="driver-details">
                                                <span><i class="far fa-user-circle"></i> <i class="fas "> Odiedo Paul</i></span><br>
                                                <span><i class="fas fa-phone-square-alt"></i> <i class="fas "> +254 759 680 813</i></span><br>
                                                <span><i class="far fa-envelope"></i> <i class="fas "> odiedo@gmail.com</i></span>
                                            </div>
                                        </div>
                                        <div class="map-frame">
                                            <iframe src="https://www.google.com/maps/embed?pb=!1m16!1m12!1m3!1d63677.445343022635!2d39.618213971379475!3d-4.052967066957563!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!2m1!1sspare%20parts%20store%2C%20kenya!5e0!3m2!1sen!2ske!4v1721122510891!5m2!1sen!2ske" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade" class="map"></iframe>
                                        </div>
                                        <div class="truck-request-trans p-2">
                                            <div class="truck-request d-flex justify-content-between p-2">
                                                <button class="btn"><i class="fas fa-wave-square"></i><br>Request</button>
                                                <button class="btn"><i class="fas fa-toolbox"></i><br>Repair</button>
                                                <button class="btn"><i class="fas fa-camera-retro"></i><br>Complete </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- Recents tab -->
                                <div class="tab-pane fade" id="recents" role="tabpanel">
                                    <div class="recents mt-3 p-3">
                                        <div class="d-flex justify-content-between">
                                            <h3>Recent Messages</h3>
                                            <span class="tokens p-2">300</span>
                                        </div>
                                        <ul class="list-group mt-3">
                                            <li class="list-group-item">Hello World ... <span class="float-right">Yesterday</span></li>
                                            <li class="list-group-item">Good morning... <span class="float-right">2 days ago</span></li>
                                            <li class="list-group-item">We are delig...<span class="float-right">3 days ago</span></li>
                                        </ul>
                                        <textarea name="message" id="message" class="form-control shadow" placeholder="Write your Message here!!!" maxlength="240" rows="4"></textarea>
                                    </div>
                                </div>
                                <!-- Contacts tab -->
                                <div class="tab-pane fade" id="contacts" role="tabpanel">
                                    <div class="contacts mt-3 p-3">
                                        <div class="d-flex justify-content-between">
                                            <h3>Contact list</h3>
                                            <span class="tokens p-2">300</span>
                                        </div>
                                        <div class="col pt-2">
                                            <input type="text" class="form-control" placeholder="Search or dial">
                                        </div>

                                        <ul class="list-group mt-3" id="contactList">

                                        </ul>
                                    </div>
                                </div>
                                <!-- aDD Contacts tab -->
                                <div class="tab-pane fade" id="addContacts" role="tabpanel">
                                    <div class="contacts mt-3 p-3">
                                        <div class="d-flex justify-content-between">
                                            <h3>Add Contact</h3>
                                        </div>
                                        <div class="col pt-2">
                                            <input type="text" class="form-control" placeholder="Search or dial">
                                        </div>

                                        <form action="add_contact.php" method="post">
                                            <label for="name">Name:</label><br>
                                            <input type="text" id="name" class="form-control" name="name" required>
                                            <label for="phone_number">Phone Number:</label>
                                            <input type="text" id="phone_number" class="form-control" name="phone_number" required><br>
                                            <input type="submit" value="Add Contact" class="btn ">
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Tabs for navigation -->
                        <!-- <ul class="nav nav-tabs mt-3" id="phoneTab" role="tablist">
                            <li class="nav-item">
                                <a class="nav-link active" id="driver-tab" data-toggle="tab" href="#driver" role="tab">compose</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" id="recents-tab" data-toggle="tab" href="#recents" role="tab">Recents</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" id="contacts-tab" data-toggle="tab" href="#contacts" role="tab">Contacts</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" id="addContacts" data-toggle="tab" href="#addContacts" role="tab">Add</a>
                            </li>
                        </ul> -->
                    </div>
                </div>
            </div>        
        </div>
      </div>
    </main>
    <script>
        fetch('get_contacts.php')
            .then(response => response.json())
            .then(data => {
                const contactList = document.getElementById('contactList');
                data.forEach(contact => {
                    const li = document.createElement('li');
                    li.textContent = `${contact.name}: ${contact.phone_number}`;
                    contactList.appendChild(li);
                });
            })
            .catch(error => console.error('Error fetching contacts:', error));
        
        $(document).ready(function() {
            $('#addContactForm').submit(function(event) {
                event.preventDefault(); // Prevent the default form submission
                const formData = $(this).serialize();
                
                $.ajax({
                    type: 'POST',
                    url: 'add_contact.php',
                    data: formData,
                    success: function(response) {
                        $('#alert-placeholder').html(`
                            <div class="alert alert-success alert-dismissible fade show" role="alert">
                                New contact added successfully.
                                <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                        `);
                        $('#addContactForm')[0].reset(); // Reset the form fields
                        // Optionally, you can refresh the contact list
                        fetchContacts();
                    },
                    error: function() {
                        $('#alert-placeholder').html(`
                            <div class="alert alert-danger alert-dismissible fade show" role="alert">
                                There was an error adding the contact.
                                <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                        `);
                    }
                });
            });

            function fetchContacts() {
                fetch('get_contacts.php')
                    .then(response => response.json())
                    .then(data => {
                        const contactList = document.getElementById('contactList');
                        contactList.innerHTML = ''; // Clear the existing list
                        data.forEach(contact => {
                            const li = document.createElement('li');
                            li.textContent = `${contact.name}: ${contact.phone_number}`;
                            contactList.appendChild(li);
                        });
                    })
                    .catch(error => console.error('Error fetching contacts:', error));
            }
        });
    </script>
  <script src="jquery/jquery-3.3.1.min.js"></script>
  <script src="assets/dist/js/bootstrap.bundle.js"></script>
  <script src="assets/dist/js/bootstrap.min.js"></script>
</body>
</html>
